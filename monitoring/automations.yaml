- id: '9962189825549'
  alias: "Alerte ConnectivitÃ© Zigbee2MQTT"
  description: "Notification si le pont Zigbee2MQTT est dÃ©connectÃ© ou indisponible"
  trigger:
    # Cas 1 : Le pont signale qu'il est hors ligne
    - platform: state
      entity_id: binary_sensor.zigbee2mqtt_bridge_connection_state
      to: "off"
      for:
        minutes: 5
    # Cas 2 : Le service est plantÃ© (l'entitÃ© ne rÃ©pond plus du tout)
    - platform: state
      entity_id: binary_sensor.zigbee2mqtt_bridge_connection_state
      to: "unavailable"
      for:
        minutes: 5
  action:
    # Notification persistante dans l'interface Home Assistant
    - action: persistent_notification.create
      data:
        title: "ğŸš¨ SystÃ¨me : Zigbee Hors Ligne"
        message: "Le pont Zigbee2MQTT est dÃ©connectÃ© depuis plus de 5 minutes. VÃ©rifiez l'Ã©tat du module complÃ©mentaire."

    # Notification sur votre tÃ©lÃ©phone (Remplacez par votre device)
    - action: notify.mobile_app_votre_telephone
      data:
        title: "ğŸš¨ Alerte Zigbee"
        message: "La connexion au pont Zigbee2MQTT est perdue !"
        data:
          priority: high
          color: "red"
          # Permet de regrouper les notifications si le problÃ¨me persiste
          tag: "z2m-disconnect"
  mode: single
- id: '9962189825550'
  alias: "Notification Mise Ã  Jour HACS"
  description: "Alerte quand une mise Ã  jour HACS ou une intÃ©gration HACS est disponible."
  trigger:
    - platform: state
      entity_id: update.hacs # Verifiez si c'est update.hacs ou update.hacs_update
      to: "on"
  action:
    # Notification sur le tableau de bord
    - action: persistent_notification.create
      data:
        title: "ğŸš€ Mise Ã  jour HACS"
        message: >
          Une nouvelle version ({{ state_attr('update.hacs', 'latest_version') }}) est disponible. 
          Version installÃ©e : {{ state_attr('update.hacs', 'installed_version') }}.
          [Voir les changements]({{ state_attr('update.hacs', 'release_url') }})

    # Notification sur votre tÃ©lÃ©phone (Optionnel)
    - action: notify.mobile_app_your_phone
      data:
        title: "ğŸš€ Mise Ã  jour HACS"
        message: "Version {{ state_attr('update.hacs', 'latest_version') }} est prÃªte."
        data:
          clickAction: "{{ state_attr('update.hacs', 'release_url') }}"
          url: "{{ state_attr('update.hacs', 'release_url') }}"